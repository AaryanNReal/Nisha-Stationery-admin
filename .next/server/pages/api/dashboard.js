"use strict";(()=>{var e={};e.id=222,e.ids=[222],e.modules={1185:e=>{e.exports=require("mongoose")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},8448:(e,t,r)=>{r.r(t),r.d(t,{config:()=>m,default:()=>l,routeModule:()=>p});var n={};r.r(n),r.d(n,{default:()=>c});var i=r(1802),a=r(7153),o=r(6249),d=r(6994),s=r(9872),u=r(8350);async function c(e,t){await (0,d.Z)();try{let e=await u.x.countDocuments(),r=await s.K.countDocuments(),n=(await s.K.find().select("line_items")).reduce((e,t)=>e+t.line_items.reduce((e,t)=>e+(t.price_data?.unit_amount||0)*t.quantity,0),0),i=await s.K.find().sort({createdAt:-1}).limit(5),a=await u.x.find().sort({createdAt:-1}).limit(5);t.json({totalProducts:e,totalOrders:r,totalRevenue:n,recentOrders:i,recentProducts:a})}catch(e){console.error("Error fetching dashboard data:",e),t.status(500).json({message:"Internal server error"})}}let l=(0,o.l)(n,"default"),m=(0,o.l)(n,"config"),p=new i.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/dashboard",pathname:"/api/dashboard",bundlePath:"",filename:""},userland:n})},9872:(e,t,r)=>{r.d(t,{K:()=>a});var n=r(1185);let i=new n.Schema({line_items:Object,name:String,email:String,city:String,postalCode:String,streetAddress:String,country:String,paid:Boolean},{timestamps:!0}),a=n.models?.Order||(0,n.model)("Order",i)},8350:(e,t,r)=>{r.d(t,{x:()=>o});var n=r(1185),i=r.n(n);let a=new n.Schema({title:{type:String,required:!0},description:String,price:{type:Number,required:!0},images:[{type:String}],category:{type:i().Types.ObjectId,ref:"Category",default:null},properties:{type:Object}},{timestamps:!0}),o=n.models.Product||(0,n.model)("Product",a)},6994:(e,t,r)=>{r.d(t,{Z:()=>a});var n=r(1185),i=r.n(n);function a(){if(1===i().connection.readyState)return i().connection.asPromise();{let e=process.env.MONGODB_URI;return i().connect(e)}}},7153:(e,t)=>{var r;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return r}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(r||(r={}))},1802:(e,t,r)=>{e.exports=r(145)}};var t=require("../../webpack-api-runtime.js");t.C(e);var r=t(t.s=8448);module.exports=r})();